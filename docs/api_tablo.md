# API терминала покупателя
<!--
<iframe src="path/to/local/swagger-ui?url=../docs/diagrams/api.json" width="100%" height="800"></iframe>
-->
<swagger-ui src= "https://raw.githubusercontent.com/tsvetkoviu/RoboFFRv1/master/docs/diagrams/api_tablo.yml" />

## Бизнес-описание API для системы управления заказами

### Общее назначение
API предназначено для автоматизации процессов работы с заказами в системе "Табло покупателя". Оно позволяет:
- Управлять содержимым корзины товаров
- Обрабатывать платежи
- Контролировать статусы заказов

### Основные функциональные блоки

#### 1. Управление корзиной
##### Добавление товаров
- Метод: `POST /api/cart/add`
- Принимает: ID товара, количество, идентификатор пользователя
- Возвращает: обновленное состояние корзины с итоговой суммой
- Бизнес-правила:
  - Минимальное количество товара: 1
  - Обязательные поля: product_id, quantity

##### Просмотр корзины
- Метод: `GET /api/cart`
- Возвращает: полный список товаров в корзине с ценами и общую сумму

#### 2. Оплата заказов
##### Создание платежа
- Метод: `POST /api/payment/create`
- Принимает: ID заказа, сумму, метод оплаты
- Возвращает: ID платежа, статус и ссылку для подтверждения
- Поддерживаемые методы оплаты:
  - card (банковская карта)
  - apple_pay
  - google_pay

### Бизнес-логика

#### Процесс оформления заказа
1. Пользователь добавляет товары в корзину
2. Система рассчитывает итоговую сумму
3. Пользователь инициирует платеж
4. Система создает транзакцию в платежной системе
5. При успешной оплате заказ переходит в статус "В обработке"

#### Обработка ошибок
- При неудачном добавлении в корзину: возвращается статус "error"
- При проблемах с оплатой: статус платежа "failed"

### Интеграционные возможности
API поддерживает интеграцию с:
- Платежными системами (через confirmation_url)
- CRM-системами (через передачу данных о заказах)
- Системами аналитики (данные о продажах)

### Безопасность
- Аутентификация: JWT-токены (Bearer Auth)
- Обязательное шифрование: TLS 1.2+
- Валидация всех входящих данных

### Примеры бизнес-сценариев

#### Успешное оформление заказа
1. Клиент добавляет 2 бургера в корзину
2. Система показывает сумму 500 ₽
3. Клиент подтверждает оплату картой
4. Платежная система возвращает подтверждение
5. Заказ появляется на табло со статусом "Готовится"

### Дополнительные возможности
- Настройка лимитов на количество товаров
- Интеграция с программами лояльности
- Кастомизация сообщений об ошибках

---
